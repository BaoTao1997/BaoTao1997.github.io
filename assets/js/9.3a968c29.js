(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{184:function(t,s,a){t.exports=a.p+"assets/img/render.7151049e.jpg"},185:function(t,s,a){t.exports=a.p+"assets/img/renderTree.a6ed6452.jpg"},274:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"css的重绘和重排"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#css的重绘和重排","aria-hidden":"true"}},[t._v("#")]),t._v(" CSS的重绘和重排")]),t._v(" "),n("p",[t._v("不能用"),n("code",[t._v("CSS")]),t._v("通配符 "),n("code",[t._v("*")]),t._v("，"),n("code",[t._v("CSS")]),t._v("选择器层叠不能超过三层，"),n("code",[t._v("CSS")]),t._v("尽量使用类选择器，书写"),n("code",[t._v("HTML")]),t._v("少使用"),n("code",[t._v("table")]),t._v("，结构要尽量简单-"),n("code",[t._v("DOM")]),t._v("树要小,不使用"),n("code",[t._v("table")]),t._v("标签等")]),t._v(" "),n("h3",{attrs:{id:"浏览器解析的工作流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#浏览器解析的工作流程","aria-hidden":"true"}},[t._v("#")]),t._v(" 浏览器解析的工作流程")]),t._v(" "),n("p",[n("img",{attrs:{src:a(184),alt:"浏览器解析的工作流程"}})]),t._v(" "),n("ol",[n("li",[t._v("**解析HTML以构建DOM树：**渲染引擎开始解析HTML文档，转换树中的html标签或js生成的标签到DOM节点，它被称为 -- 内容树。")]),t._v(" "),n("li",[t._v("**构建渲染树：**解析CSS（包括外部CSS文件和样式元素以及js生成的样式），根据CSS选择器计算出节点的样式，创建另一个树 —- 渲染树。")]),t._v(" "),n("li",[n("strong",[t._v("布局渲染树:")]),t._v(" 从DOM树的根节点开始遍历每个可见节点。对于每个可见的节点，找到CSSOM树中对应的规则，并应用它们。根据每个可见节点以及其对应的样式，组合生成渲染树。")]),t._v(" "),n("li",[n("strong",[t._v("绘制渲染树:")]),t._v(" 遍历渲染树，每个节点将使用UI后端层来绘制。")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(185),alt:"生成渲染树"}})]),t._v(" "),n("h3",{attrs:{id:"重排"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重排","aria-hidden":"true"}},[t._v("#")]),t._v(" 重排")]),t._v(" "),n("p",[t._v("当DOM的变化影响了元素的几何信息(DOM对象的位置和尺寸大小)，浏览器需要重新计算元素的几何属性，将其安放在界面中的正确位置，这个过程称之为"),n("strong",[t._v("reflow")]),t._v("(也称为回流)")]),t._v(" "),n("h4",{attrs:{id:"重排比重绘大"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重排比重绘大","aria-hidden":"true"}},[t._v("#")]),t._v(" 重排比重绘大")]),t._v(" "),n("p",[n("strong",[t._v("单单改变元素的外观，肯定不会引起网页重新生成布局，但当浏览器完成重排之后，将会重新绘制受到此次重排影响的部分")]),t._v("。")]),t._v(" "),n("blockquote",[n("p",[n("strong",[t._v('"重绘"不一定会出现"重排"，"重排"必然会出现"重绘"')])])]),t._v(" "),n("h4",{attrs:{id:"常见引起重排属性和方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常见引起重排属性和方法","aria-hidden":"true"}},[t._v("#")]),t._v(" 常见引起重排属性和方法")]),t._v(" "),n("p",[n("strong",[t._v("任何会改变元素几何信息(元素的位置和尺寸大小)的操作，都会触发重排")]),t._v(":")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("添加或者删除可见的DOM元素")])]),t._v(" "),n("li",[n("p",[t._v("元素尺寸改变——边距、填充、边框、宽度和高度")])]),t._v(" "),n("li",[n("p",[t._v("内容变化，比如用户在input框中输入文字")])]),t._v(" "),n("li",[n("p",[t._v("浏览器窗口尺寸改变——resize事件发生时")])]),t._v(" "),n("li",[n("p",[t._v("计算 offsetWidth 和 offsetHeight 属性等:")])]),t._v(" "),n("li",[n("p",[t._v("设置 style 属性的值")])])]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("常见引起重排属性和方法")]),t._v(" "),n("th"),t._v(" "),n("th"),t._v(" "),n("th")])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("width")]),t._v(" "),n("td",[t._v("height")]),t._v(" "),n("td",[t._v("margin")]),t._v(" "),n("td",[t._v("padding")])]),t._v(" "),n("tr",[n("td",[t._v("display")]),t._v(" "),n("td",[t._v("border")]),t._v(" "),n("td",[t._v("position")]),t._v(" "),n("td",[t._v("overflow")])]),t._v(" "),n("tr",[n("td",[t._v("clientWidth")]),t._v(" "),n("td",[t._v("clientHeight")]),t._v(" "),n("td",[t._v("clientTop")]),t._v(" "),n("td",[t._v("clientLeft")])]),t._v(" "),n("tr",[n("td",[t._v("offsetWidth")]),t._v(" "),n("td",[t._v("offsetHeight")]),t._v(" "),n("td",[t._v("offsetTop")]),t._v(" "),n("td",[t._v("offsetLeft")])]),t._v(" "),n("tr",[n("td",[t._v("scrollWidth")]),t._v(" "),n("td",[t._v("scrollHeight")]),t._v(" "),n("td",[t._v("scrollTop")]),t._v(" "),n("td",[t._v("scrollLeft")])]),t._v(" "),n("tr",[n("td",[t._v("scrollIntoView()")]),t._v(" "),n("td",[t._v("scrollTo()")]),t._v(" "),n("td",[t._v("getComputedStyle()")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("getBoundingClientRect()")]),t._v(" "),n("td",[t._v("scrollIntoViewIfNeeded()")]),t._v(" "),n("td"),t._v(" "),n("td")])])]),t._v(" "),n("h4",{attrs:{id:"重排影响范围"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重排影响范围","aria-hidden":"true"}},[t._v("#")]),t._v(" 重排影响范围")]),t._v(" "),n("p",[t._v("由于浏览器渲染界面是基于流布局模型的，所以触发重排时会对周围DOM重新排列，影响的范围有两种：")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("全局范围：从根节点"),n("code",[t._v("html")]),t._v("开始对整个渲染树进行重新布局。")])]),t._v(" "),n("li",[n("p",[t._v("局部范围：对渲染树的某部分或某一个渲染对象进行重新布局")])])]),t._v(" "),n("p",[n("strong",[t._v("全局范围重排")]),t._v("：")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('<body>\n  <div class="hello">\n    <h4>hello</h4>\n    <p><strong>Name:</strong>BDing</p>\n    <h5>male</h5>\n    <ol>\n      <li>coding</li>\n      <li>loving</li>\n    </ol>\n  </div>\n</body>\n复制代码\n')])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br")])]),n("p",[t._v("当p节点上发生reflow时，hello和body也会重新渲染，甚至h5和ol都会收到影响。")]),t._v(" "),n("p",[n("strong",[t._v("局部范围重排：")])]),t._v(" "),n("p",[t._v("用局部布局来解释这种现象：把一个dom的宽高之类的几何信息定死，然后在dom内部触发重排，就只会重新渲染该dom内部的元素，而不会影响到外界。")]),t._v(" "),n("h3",{attrs:{id:"重绘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重绘","aria-hidden":"true"}},[t._v("#")]),t._v(" 重绘")]),t._v(" "),n("p",[t._v("当一个元素的外观发生改变，但没有改变布局,重新把元素外观绘制出来的过程，这个过程称之为"),n("strong",[t._v("repaint")])]),t._v(" "),n("p",[n("strong",[t._v("常见的引起重绘的属性")]),t._v(":")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("常见引起重绘属性和方法")]),t._v(" "),n("th"),t._v(" "),n("th"),t._v(" "),n("th")])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("color")]),t._v(" "),n("td",[t._v("border-style")]),t._v(" "),n("td",[t._v("visibility")]),t._v(" "),n("td",[t._v("background")])]),t._v(" "),n("tr",[n("td",[t._v("text-decoration")]),t._v(" "),n("td",[t._v("background-image")]),t._v(" "),n("td",[t._v("background-position")]),t._v(" "),n("td",[t._v("background-repeat")])]),t._v(" "),n("tr",[n("td",[t._v("outline-color")]),t._v(" "),n("td",[t._v("outline")]),t._v(" "),n("td",[t._v("outline-style")]),t._v(" "),n("td",[t._v("border-radius")])]),t._v(" "),n("tr",[n("td",[t._v("outline-width")]),t._v(" "),n("td",[t._v("box-shadow")]),t._v(" "),n("td",[t._v("background-size")]),t._v(" "),n("td")])])]),t._v(" "),n("h3",{attrs:{id:"浏览器的渲染队列"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的渲染队列","aria-hidden":"true"}},[t._v("#")]),t._v(" 浏览器的渲染队列")]),t._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[t._v("div"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("left "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndiv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("top "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndiv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'20px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndiv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("height "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'20px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("p",[t._v("由于浏览器的"),n("strong",[t._v("渲染队列机制")]),t._v(",理论上会触发4次重排+重绘，因为每一次都改变了元素的几何属性，实际上最后只触发了一次重排")]),t._v(" "),n("p",[t._v("修改了元素的几何属性，导致浏览器触发重排或重绘时。它会把该操作放进渲染队列，等到队列中的操作到了"),n("strong",[t._v("一定的数量或者到了一定的时间间隔")]),t._v("时，浏览器就会批量执行这些操作")]),t._v(" "),n("h4",{attrs:{id:"强制刷新队列"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#强制刷新队列","aria-hidden":"true"}},[t._v("#")]),t._v(" 强制刷新队列")]),t._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[t._v("div"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("left "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetLeft"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndiv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("top "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetTop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndiv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'20px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetWidth"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndiv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("height "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'20px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetHeight"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br")])]),n("p",[t._v("这段代码会触发4次重排+重绘，因为在"),n("code",[t._v("console")]),t._v("中你请求的这几个样式信息，无论何时浏览器都会立即执行渲染队列的任务，即使该值与你操作中修改的值没关联")]),t._v(" "),n("p",[n("strong",[t._v("因为队列中，可能会有影响到这些值的操作，为了给我们最精确的值，浏览器会立即重排+重绘")]),t._v("。")]),t._v(" "),n("p",[n("strong",[t._v("强制刷新队列的style样式请求")]),t._v("：")]),t._v(" "),n("ol",[n("li",[t._v("offsetTop, offsetLeft, offsetWidth, offsetHeight")]),t._v(" "),n("li",[t._v("scrollTop, scrollLeft, scrollWidth, scrollHeight")]),t._v(" "),n("li",[t._v("clientTop, clientLeft, clientWidth, clientHeight")]),t._v(" "),n("li",[t._v("getComputedStyle(), 或者 IE的 currentStyle")])]),t._v(" "),n("h3",{attrs:{id:"重排优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重排优化","aria-hidden":"true"}},[t._v("#")]),t._v(" 重排优化")]),t._v(" "),n("h4",{attrs:{id:"_1-分离读写操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-分离读写操作","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.分离读写操作")]),t._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[t._v("div"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("left "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndiv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("top "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndiv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'20px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndiv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("height "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'20px'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetLeft"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetTop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetWidth"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetHeight"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br")])]),n("p",[t._v("还是上面触发4次重排+重绘的代码，这次只触发了一次重排：")]),t._v(" "),n("p",[t._v("在第一个"),n("code",[t._v("console")]),t._v("的时候，浏览器把之前上面四个写操作的渲染队列都给清空了。剩下的console，因为渲染队列本来就是空的，所以并没有触发重排，仅仅拿值而已。")]),t._v(" "),n("h3",{attrs:{id:"_2-样式集中改变"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-样式集中改变","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 样式集中改变")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("div.style.left = '10px';\ndiv.style.top = '10px';\ndiv.style.width = '20px';\ndiv.style.height = '20px';\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("p",[t._v("虽然现在大部分浏览器有渲染队列优化，不排除有些浏览器以及老版本的浏览器效率仍然低下：")]),t._v(" "),n("p",[t._v("建议通过改变class或者csstext属性集中改变样式")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('// bad\nvar left = 10;\nvar top = 10;\nel.style.left = left + "px";\nel.style.top  = top  + "px";\n// good \nel.className += " theclassname";\n// good\nel.style.cssText += "; left: " + left + "px; top: " + top + "px;";\n')])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br")])]),n("h3",{attrs:{id:"_3-缓存布局信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-缓存布局信息","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 缓存布局信息")]),t._v(" "),n("p",[t._v("当查询布局信息时，比如获取偏移量（offset）、滚动位置（scroll）或计算出的样式值（computedstyle values）时，浏览器为了返回最新值，会刷新队列并应用所有变更。不利于优化。")]),t._v(" "),n("p",[t._v("所以应该尽量减少布局信息的获取次数，获取后把它赋值给局部变量，然后再操作局部变量")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// bad 强制刷新 触发两次重排\ndiv.style.left = div.offsetLeft + 1 + 'px';\ndiv.style.top = div.offsetTop + 1 + 'px';\n\n// good 缓存布局信息 相当于读写分离\nvar curLeft = div.offsetLeft;\nvar curTop = div.offsetTop;\ndiv.style.left = curLeft + 1 + 'px';\ndiv.style.top = curTop + 1 + 'px';\n复制代码\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br")])]),n("h3",{attrs:{id:"_4-离线改变dom"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-离线改变dom","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. 离线改变dom")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("隐藏要操作的dom")]),t._v(" "),n("p",[t._v("在要操作dom之前，通过display隐藏dom，当操作完成之后，才将元素的display属性为可见，因为不可见的元素不会触发重排和重绘。")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("dom.display = 'none'\n// 修改dom样式\ndom.display = 'block'\n复制代码\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])])]),t._v(" "),n("li",[n("p",[t._v("通过使用"),n("a",{attrs:{href:"https://link.juejin.im?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FDocumentFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("DocumentFragment"),n("OutboundLink")],1),t._v("创建一个"),n("code",[t._v("dom")]),t._v("碎片,在它上面批量操作dom，操作完成之后，再添加到文档中，这样只会触发一次重排。")])]),t._v(" "),n("li",[n("p",[t._v("复制节点，在副本上工作，然后替换它")])])]),t._v(" "),n("h3",{attrs:{id:"_5-position属性为absolute或fixed"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-position属性为absolute或fixed","aria-hidden":"true"}},[t._v("#")]),t._v(" 5. position属性为absolute或fixed")]),t._v(" "),n("p",[t._v("position属性为absolute或fixed的元素，重排开销比较小，不用考虑它对其他元素的影响")]),t._v(" "),n("h3",{attrs:{id:"_6-优化动画"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-优化动画","aria-hidden":"true"}},[t._v("#")]),t._v(" 6. 优化动画")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("可以把动画效果应用到position属性为absolute或fixed的元素上，这样对其他元素影响较小")]),t._v(" "),n("p",[t._v("动画效果还应牺牲一些平滑，来换取速度，这中间的度自己衡量：")]),t._v(" "),n("p",[t._v("比如实现一个动画，以1个像素为单位移动这样最平滑，但是reflow就会过于频繁，大量消耗CPU资源，如果以3个像素为单位移动则会好很多。")])]),t._v(" "),n("li",[n("p",[t._v("启用GPU加速")]),t._v(" "),n("p",[t._v("此部分来自"),n("a",{attrs:{href:"https://link.juejin.im?target=http%3A%2F%2Fcaibaojian.com%2Fcss-reflow-repaint.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("优化CSS重排重绘与浏览器性能"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("strong",[t._v("GPU(图像加速器)：")])]),t._v(" "),n("p",[t._v("GPU 硬件加速是指应用 GPU 的图形性能对浏览器中的一些图形操作交给 GPU 来完成，因为 GPU 是专门为处理图形而设计，所以它在速度和能耗上更有效率。")]),t._v(" "),n("p",[t._v("GPU 加速通常包括以下几个部分：Canvas2D，布局合成, CSS3转换（transitions），CSS3 3D变换（transforms），WebGL和视频(video)。")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("/*\n * 根据上面的结论\n * 将 2d transform 换成 3d\n * 就可以强制开启 GPU 加速\n * 提高动画性能\n */\ndiv {\n  transform: translate3d(10px, 10px, 0);\n}\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br")])])])]),t._v(" "),n("h3",{attrs:{id:"为什么说dom操作很慢"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么说dom操作很慢","aria-hidden":"true"}},[t._v("#")]),t._v(" 为什么说DOM操作很慢")]),t._v(" "),n("p",[t._v("DOM对象本身也是一个js对象，所以严格来说，并不是操作这个对象慢，而是说操作了这个对象后，会触发重绘和重排现象")])])},[],!1,null,null,null);s.default=e.exports}}]);